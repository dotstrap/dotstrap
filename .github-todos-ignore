worry about the fact that I need to call flatten on arrays?