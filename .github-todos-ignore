worry about the fact that I need to call flatten on arrays?
use number of processes/threads = to procs